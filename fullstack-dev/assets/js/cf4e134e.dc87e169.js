"use strict";(self.webpackChunkdocs_site=self.webpackChunkdocs_site||[]).push([[9712],{2362:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});var i=r(2389),s=r(5813),a=r(7814);const t={slug:"nginx-web-server-guide",title:"Nginx: The High-Performance Web Server and Reverse Proxy",authors:["tam"],tags:["nginx","web-server","reverse-proxy","load-balancing","performance","devops"]},o=void 0,l={authorsImageUrls:[void 0]},c=[{value:"What is Nginx?",id:"what-is-nginx",level:2},{value:"Key Characteristics",id:"key-characteristics",level:3},{value:"Core Features",id:"core-features",level:2},{value:"1. Web Server",id:"1-web-server",level:3},{value:"2. Reverse Proxy",id:"2-reverse-proxy",level:3},{value:"3. Load Balancing",id:"3-load-balancing",level:3},{value:"4. SSL/TLS Termination",id:"4-ssltls-termination",level:3},{value:"5. Caching",id:"5-caching",level:3},{value:"Common Use Cases",id:"common-use-cases",level:2},{value:"1. Static File Serving",id:"1-static-file-serving",level:3},{value:"2. Reverse Proxy for Node.js Applications",id:"2-reverse-proxy-for-nodejs-applications",level:3},{value:"3. Load Balancing",id:"3-load-balancing-1",level:3},{value:"4. SSL/HTTPS Configuration",id:"4-sslhttps-configuration",level:3},{value:"Nginx vs Apache",id:"nginx-vs-apache",level:2},{value:"Installation and Basic Setup",id:"installation-and-basic-setup",level:2},{value:"Ubuntu/Debian",id:"ubuntudebian",level:3},{value:"CentOS/RHEL",id:"centosrhel",level:3},{value:"macOS (with Homebrew)",id:"macos-with-homebrew",level:3},{value:"macOS M4 Chip Specific Setup",id:"macos-m4-chip-specific-setup",level:3},{value:"M4-Optimized Configuration",id:"m4-optimized-configuration",level:4},{value:"Common M4 Considerations",id:"common-m4-considerations",level:4},{value:"Basic Configuration Structure",id:"basic-configuration-structure",level:2},{value:"Performance Optimization Tips",id:"performance-optimization-tips",level:2},{value:"1. Worker Processes",id:"1-worker-processes",level:3},{value:"2. Worker Connections",id:"2-worker-connections",level:3},{value:"4. Gzip Compression",id:"4-gzip-compression",level:3},{value:"5. Browser Caching",id:"5-browser-caching",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"1. Hide Nginx Version",id:"1-hide-nginx-version",level:3},{value:"2. Rate Limiting",id:"2-rate-limiting",level:3},{value:"Advanced Rate Limiting Configurations",id:"advanced-rate-limiting-configurations",level:4},{value:"3. Security Headers",id:"3-security-headers",level:3},{value:"Comprehensive Security Headers Explained",id:"comprehensive-security-headers-explained",level:4},{value:"Complete Security Headers Configuration",id:"complete-security-headers-configuration",level:4},{value:"Environment-Specific Configurations",id:"environment-specific-configurations",level:4},{value:"Security Headers Testing and Validation",id:"security-headers-testing-and-validation",level:4},{value:"Modern Web Development with Nginx",id:"modern-web-development-with-nginx",level:2},{value:"Microservices Architecture",id:"microservices-architecture",level:3},{value:"API Gateway",id:"api-gateway",level:3},{value:"Monitoring and Logging",id:"monitoring-and-logging",level:2},{value:"Access Logs",id:"access-logs",level:3},{value:"Error Logs",id:"error-logs",level:3},{value:"Status Module",id:"status-module",level:3},{value:"Conclusion",id:"conclusion",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:'Nginx (pronounced "engine-x") is one of the most popular and powerful web servers in the world, powering over 30% of all websites on the internet. Originally created by Igor Sysoev in 2004 to solve the C10K problem (handling 10,000 concurrent connections), Nginx has evolved into a versatile tool that serves as a web server, reverse proxy, load balancer, and HTTP cache.'}),"\n",(0,s.jsx)(n.p,{children:"In this comprehensive guide, we'll explore what makes Nginx special, its key features, common use cases, and how to get started with basic configurations."}),"\n",(0,s.jsx)(n.h2,{id:"what-is-nginx",children:"What is Nginx?"}),"\n",(0,s.jsx)(n.p,{children:"Nginx is an open-source web server that can also function as a reverse proxy, load balancer, mail proxy, and HTTP cache. Unlike traditional web servers that create a new thread or process for each request, Nginx uses an event-driven, asynchronous architecture that allows it to handle thousands of concurrent connections with minimal resource usage."}),"\n",(0,s.jsx)(n.h3,{id:"key-characteristics",children:"Key Characteristics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"High Performance"}),": Handles thousands of concurrent connections efficiently"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Low Memory Usage"}),": Uses significantly less memory compared to Apache"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Event-Driven Architecture"}),": Non-blocking I/O operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Modular Design"}),": Extensible through modules"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configuration Flexibility"}),": Simple yet powerful configuration syntax"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"core-features",children:"Core Features"}),"\n",(0,s.jsx)(n.h3,{id:"1-web-server",children:"1. Web Server"}),"\n",(0,s.jsx)(n.p,{children:"Nginx can serve static content (HTML, CSS, JavaScript, images) extremely efficiently. Its ability to handle static files makes it an excellent choice for serving modern web applications."}),"\n",(0,s.jsx)(n.h3,{id:"2-reverse-proxy",children:"2. Reverse Proxy"}),"\n",(0,s.jsx)(n.p,{children:"Acts as an intermediary between clients and backend servers, forwarding client requests to appropriate backend services and returning responses back to clients."}),"\n",(0,s.jsx)(n.h3,{id:"3-load-balancing",children:"3. Load Balancing"}),"\n",(0,s.jsx)(n.p,{children:"Distributes incoming requests across multiple backend servers to ensure optimal resource utilization and prevent any single server from becoming overwhelmed."}),"\n",(0,s.jsx)(n.h3,{id:"4-ssltls-termination",children:"4. SSL/TLS Termination"}),"\n",(0,s.jsx)(n.p,{children:"Handles SSL/TLS encryption and decryption, offloading this computationally intensive task from backend servers."}),"\n",(0,s.jsx)(n.h3,{id:"5-caching",children:"5. Caching"}),"\n",(0,s.jsx)(n.p,{children:"Provides HTTP caching capabilities to store frequently requested content, reducing load on backend servers and improving response times."}),"\n",(0,s.jsx)(n.h2,{id:"common-use-cases",children:"Common Use Cases"}),"\n",(0,s.jsx)(n.h3,{id:"1-static-file-serving",children:"1. Static File Serving"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'server {\n    listen 80;\n    server_name example.com;\n    root /var/www/html;\n    \n    location / {\n        try_files $uri $uri/ =404;\n    }\n    \n    location ~* \\.(jpg|jpeg|png|gif|ico|css|js)$ {\n        expires 1y;\n        add_header Cache-Control "public, immutable";\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"2-reverse-proxy-for-nodejs-applications",children:"2. Reverse Proxy for Node.js Applications"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80;\n    server_name api.example.com;\n    \n    location / {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_cache_bypass $http_upgrade;\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-load-balancing-1",children:"3. Load Balancing"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"upstream backend {\n    server backend1.example.com;\n    server backend2.example.com;\n    server backend3.example.com;\n}\n\nserver {\n    listen 80;\n    server_name example.com;\n    \n    location / {\n        proxy_pass http://backend;\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-sslhttps-configuration",children:"4. SSL/HTTPS Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 443 ssl http2;\n    server_name example.com;\n    \n    ssl_certificate /path/to/certificate.crt;\n    ssl_certificate_key /path/to/private.key;\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;\n    \n    location / {\n        root /var/www/html;\n        index index.html;\n    }\n}\n\n# Redirect HTTP to HTTPS\nserver {\n    listen 80;\n    server_name example.com;\n    return 301 https://$server_name$request_uri;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"nginx-vs-apache",children:"Nginx vs Apache"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"Nginx"}),(0,s.jsx)(n.th,{children:"Apache"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Architecture"})}),(0,s.jsx)(n.td,{children:"Event-driven, asynchronous"}),(0,s.jsx)(n.td,{children:"Process/thread-based"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Memory Usage"})}),(0,s.jsx)(n.td,{children:"Lower"}),(0,s.jsx)(n.td,{children:"Higher"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Static Content"})}),(0,s.jsx)(n.td,{children:"Excellent performance"}),(0,s.jsx)(n.td,{children:"Good performance"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Configuration"})}),(0,s.jsx)(n.td,{children:"Centralized config files"}),(0,s.jsx)(n.td,{children:".htaccess + main config"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Modules"})}),(0,s.jsx)(n.td,{children:"Dynamic loading"}),(0,s.jsx)(n.td,{children:"Both static and dynamic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Learning Curve"})}),(0,s.jsx)(n.td,{children:"Moderate"}),(0,s.jsx)(n.td,{children:"Easier for beginners"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"installation-and-basic-setup",children:"Installation and Basic Setup"}),"\n",(0,s.jsx)(n.h3,{id:"ubuntudebian",children:"Ubuntu/Debian"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install nginx\nsudo systemctl start nginx\nsudo systemctl enable nginx\n"})}),"\n",(0,s.jsx)(n.h3,{id:"centosrhel",children:"CentOS/RHEL"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo yum install epel-release\nsudo yum install nginx\nsudo systemctl start nginx\nsudo systemctl enable nginx\n"})}),"\n",(0,s.jsx)(n.h3,{id:"macos-with-homebrew",children:"macOS (with Homebrew)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"brew install nginx\nbrew services start nginx\n"})}),"\n",(0,s.jsx)(n.h3,{id:"macos-m4-chip-specific-setup",children:"macOS M4 Chip Specific Setup"}),"\n",(0,s.jsx)(n.p,{children:"For Apple Silicon M4 processors, you may need to install Homebrew for ARM64 architecture if not already done:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Install Homebrew (if not already installed)\n/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"\n\n# Ensure you\'re using ARM64 architecture\narch\n# Should output: arm64\n\n# Install Nginx optimized for M4\nbrew install nginx\n\n# Verify installation and architecture\nfile $(brew --prefix)/bin/nginx\n# Should show: Mach-O 64-bit executable arm64\n\n# Start Nginx with optimized settings for M4\nbrew services start nginx\n\n# Check if running\nbrew services list | grep nginx\n'})}),"\n",(0,s.jsx)(n.h4,{id:"m4-optimized-configuration",children:"M4-Optimized Configuration"}),"\n",(0,s.jsx)(n.p,{children:"For optimal performance on M4 chips, consider these configuration adjustments:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# /opt/homebrew/etc/nginx/nginx.conf (M4 optimized)\nuser _www;\nworker_processes auto;  # M4 has efficient cores, auto-detection works well\nerror_log /opt/homebrew/var/log/nginx/error.log;\n\nevents {\n    worker_connections 2048;  # M4 can handle higher connections efficiently\n    use kqueue;  # Optimal for macOS\n    multi_accept on;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n    \n    # M4 optimization settings\n    sendfile on;\n    tcp_nopush on;\n    tcp_nodelay on;\n    \n    # Buffer sizes optimized for M4 memory bandwidth\n    client_body_buffer_size 128k;\n    client_max_body_size 10m;\n    client_header_buffer_size 1k;\n    large_client_header_buffers 4 4k;\n    output_buffers 1 32k;\n    postpone_output 1460;\n    \n    server {\n        listen 8080;  # Default Homebrew port\n        server_name localhost;\n        root /opt/homebrew/var/www;\n        index index.html index.htm;\n        \n        location / {\n            try_files $uri $uri/ =404;\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"common-m4-considerations",children:"Common M4 Considerations"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"File Paths"}),": Homebrew on M4 installs to ",(0,s.jsx)(n.code,{children:"/opt/homebrew/"})," instead of ",(0,s.jsx)(n.code,{children:"/usr/local/"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Default Port"}),": Homebrew Nginx typically runs on port 8080 to avoid permission issues"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Process Management"}),": Use ",(0,s.jsx)(n.code,{children:"brew services"})," for better integration with macOS"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Performance"}),": M4's efficiency cores handle Nginx's event-driven architecture exceptionally well"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# M4-specific paths\nConfiguration: /opt/homebrew/etc/nginx/nginx.conf\nDocument root: /opt/homebrew/var/www\nError log: /opt/homebrew/var/log/nginx/error.log\nAccess log: /opt/homebrew/var/log/nginx/access.log\n"})}),"\n",(0,s.jsx)(n.h2,{id:"basic-configuration-structure",children:"Basic Configuration Structure"}),"\n",(0,s.jsxs)(n.p,{children:["Nginx configuration is typically located at ",(0,s.jsx)(n.code,{children:"/etc/nginx/nginx.conf"})," and follows a hierarchical structure:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# Main context\nuser nginx;\nworker_processes auto;\nerror_log /var/log/nginx/error.log;\n\n# Events context\nevents {\n    worker_connections 1024;\n}\n\n# HTTP context\nhttp {\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n    \n    # Server context\n    server {\n        listen 80;\n        server_name example.com;\n        \n        # Location context\n        location / {\n            root /var/www/html;\n            index index.html;\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"performance-optimization-tips",children:"Performance Optimization Tips"}),"\n",(0,s.jsx)(n.h3,{id:"1-worker-processes",children:"1. Worker Processes"}),"\n",(0,s.jsx)(n.p,{children:"Set worker processes to match your CPU cores:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"worker_processes auto;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-worker-connections",children:"2. Worker Connections"}),"\n",(0,s.jsx)(n.p,{children:"Increase worker connections for high-traffic sites:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"events {\n    worker_connections 2048;\n    use epoll; # Linux\n    use kqueue; # macOS/BSD\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-gzip-compression",children:"4. Gzip Compression"}),"\n",(0,s.jsx)(n.p,{children:"Enable compression to reduce bandwidth:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"gzip on;\ngzip_vary on;\ngzip_min_length 1024;\ngzip_types text/plain text/css application/json application/javascript text/xml application/xml;\n\n# M4 optimization: Use higher compression for better CPU/bandwidth trade-off\ngzip_comp_level 6;  # M4 can handle higher compression efficiently\ngzip_proxied any;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5-browser-caching",children:"5. Browser Caching"}),"\n",(0,s.jsx)(n.p,{children:"Set appropriate cache headers:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'location ~* \\.(jpg|jpeg|png|gif|ico|css|js)$ {\n    expires 1y;\n    add_header Cache-Control "public, immutable";\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"1-hide-nginx-version",children:"1. Hide Nginx Version"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"server_tokens off;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-rate-limiting",children:"2. Rate Limiting"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# Basic rate limiting by IP address\nlimit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;\n\n# Rate limiting by user session (requires session ID)\nlimit_req_zone $cookie_sessionid zone=session:10m rate=5r/s;\n\n# Rate limiting by server name (per domain)\nlimit_req_zone $server_name zone=domain:10m rate=100r/s;\n\n# Rate limiting by request URI (specific endpoints)\nlimit_req_zone $request_uri zone=endpoint:10m rate=2r/s;\n\n# Whitelist trusted IPs\ngeo $limit {\n    default 1;\n    10.0.0.0/8 0;     # Internal network\n    192.168.0.0/16 0; # Private network\n    127.0.0.1/32 0;   # Localhost\n}\n\nmap $limit $limit_key {\n    0 "";\n    1 $binary_remote_addr;\n}\n\nlimit_req_zone $limit_key zone=trusted:10m rate=20r/s;\n\n# Different rate limits for different locations\nlocation /api/ {\n    limit_req zone=api burst=20 nodelay;\n    limit_req_status 429;\n    limit_req_log_level warn;\n}\n\nlocation /login {\n    # Stricter rate limiting for login attempts\n    limit_req zone=api burst=5 nodelay;\n    limit_req_status 429;\n}\n\nlocation /search {\n    # Higher burst for search with delay\n    limit_req zone=api burst=50;\n}\n\nlocation /upload {\n    # Very strict rate limiting for uploads\n    limit_req_zone $binary_remote_addr zone=upload:10m rate=1r/m;\n    limit_req zone=upload burst=2;\n}\n\nlocation /public/ {\n    # Use trusted zone for public content\n    limit_req zone=trusted burst=100 nodelay;\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"advanced-rate-limiting-configurations",children:"Advanced Rate Limiting Configurations"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Multiple Rate Limits"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# Apply multiple rate limits simultaneously\nlocation /api/critical/ {\n    limit_req zone=api burst=10 nodelay;\n    limit_req zone=session burst=5 nodelay;\n    limit_req zone=endpoint burst=2 nodelay;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Dynamic Rate Limiting Based on Response Status"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# Stricter limits after failed attempts\nmap $status $loggable {\n    ~^[23] 0;  # Don't log successful requests\n    default 1;\n}\n\nlimit_req_zone $binary_remote_addr zone=strict:10m rate=1r/s;\n\nlocation /api/auth {\n    limit_req zone=api burst=10;\n    \n    # Apply stricter limits if previous requests failed\n    if ($http_x_failed_attempts) {\n        limit_req zone=strict burst=3;\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Rate Limiting with Custom Error Pages"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# Custom error page for rate limited requests\nerror_page 429 /rate_limit.html;\n\nlocation = /rate_limit.html {\n    root /var/www/error;\n    internal;\n    add_header Content-Type text/html;\n    add_header Retry-After 60;\n}\n\nlocation /api/ {\n    limit_req zone=api burst=20 nodelay;\n    limit_req_status 429;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Burst Control Strategies"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# No burst - strict limiting\nlocation /strict-api/ {\n    limit_req zone=api;\n}\n\n# Burst with delay - smoother for users\nlocation /smooth-api/ {\n    limit_req zone=api burst=10;\n}\n\n# Burst with nodelay - fast response but strict enforcement\nlocation /fast-api/ {\n    limit_req zone=api burst=10 nodelay;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-security-headers",children:"3. Security Headers"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'add_header X-Frame-Options "SAMEORIGIN" always;\nadd_header X-XSS-Protection "1; mode=block" always;\nadd_header X-Content-Type-Options "nosniff" always;\nadd_header Referrer-Policy "no-referrer-when-downgrade" always;\nadd_header Content-Security-Policy "default-src \'self\'" always;\n'})}),"\n",(0,s.jsx)(n.h4,{id:"comprehensive-security-headers-explained",children:"Comprehensive Security Headers Explained"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"X-Frame-Options"})," - Prevents Clickjacking Attacks:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# DENY: Prevents any domain from framing the content\nadd_header X-Frame-Options "DENY" always;\n\n# SAMEORIGIN: Only allows framing from the same origin\nadd_header X-Frame-Options "SAMEORIGIN" always;\n\n# ALLOW-FROM: Allows framing from specific domains\nadd_header X-Frame-Options "ALLOW-FROM https://trusted-site.com" always;\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Content-Security-Policy (CSP)"})," - Prevents XSS and Data Injection:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# Basic CSP - only allow resources from same origin\nadd_header Content-Security-Policy \"default-src 'self'\" always;\n\n# Advanced CSP for modern web applications\nadd_header Content-Security-Policy \"\n    default-src 'self';\n    script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://ajax.googleapis.com;\n    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;\n    font-src 'self' https://fonts.gstatic.com;\n    img-src 'self' data: https:;\n    connect-src 'self' https://api.example.com;\n    frame-ancestors 'none';\n    base-uri 'self';\n    form-action 'self';\n    upgrade-insecure-requests;\n\" always;\n\n# CSP for Single Page Applications (React/Vue/Angular)\nadd_header Content-Security-Policy \"\n    default-src 'self';\n    script-src 'self' 'sha256-xyz123...' 'unsafe-eval';\n    style-src 'self' 'unsafe-inline';\n    img-src 'self' data: blob: https:;\n    font-src 'self' data:;\n    connect-src 'self' wss: https:;\n    worker-src 'self' blob:;\n\" always;\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Strict-Transport-Security (HSTS)"})," - Enforces HTTPS:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# Basic HSTS - 1 year, include subdomains\nadd_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;\n\n# HSTS with preload (for submission to browsers\' preload lists)\nadd_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;\n\n# Development/staging environment (shorter duration)\nadd_header Strict-Transport-Security "max-age=300; includeSubDomains" always;\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"X-Content-Type-Options"})," - Prevents MIME Type Sniffing:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# Prevents browsers from interpreting files as different MIME types\nadd_header X-Content-Type-Options "nosniff" always;\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Referrer-Policy"})," - Controls Referrer Information:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# No referrer when protocol security is downgraded\nadd_header Referrer-Policy "no-referrer-when-downgrade" always;\n\n# Strict referrer policy options\nadd_header Referrer-Policy "strict-origin-when-cross-origin" always;\nadd_header Referrer-Policy "same-origin" always;\nadd_header Referrer-Policy "no-referrer" always;\n\n# Origin only (no path information)\nadd_header Referrer-Policy "origin" always;\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"X-XSS-Protection"})," - Legacy XSS Protection:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# Enable XSS filtering and block page rendering if attack detected\nadd_header X-XSS-Protection "1; mode=block" always;\n\n# Note: This header is largely deprecated in favor of CSP\n# Modern browsers rely on Content-Security-Policy instead\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Permissions-Policy"})," - Controls Browser Features:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# Disable potentially dangerous features\nadd_header Permissions-Policy "\n    camera=(),\n    microphone=(),\n    geolocation=(),\n    payment=(),\n    usb=(),\n    magnetometer=(),\n    gyroscope=(),\n    speaker=()\n" always;\n\n# Allow specific features for your domain only\nadd_header Permissions-Policy "\n    camera=(self),\n    microphone=(self),\n    geolocation=(self \'https://trusted-maps.com\'),\n    payment=(self)\n" always;\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cross-Origin-Embedder-Policy & Cross-Origin-Opener-Policy"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# Enable cross-origin isolation for advanced features\nadd_header Cross-Origin-Embedder-Policy "require-corp" always;\nadd_header Cross-Origin-Opener-Policy "same-origin" always;\n\n# More permissive options\nadd_header Cross-Origin-Embedder-Policy "credentialless" always;\nadd_header Cross-Origin-Opener-Policy "same-origin-allow-popups" always;\n'})}),"\n",(0,s.jsx)(n.h4,{id:"complete-security-headers-configuration",children:"Complete Security Headers Configuration"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Production-Ready Security Headers Set"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# Complete security headers configuration\nlocation / {\n    # HSTS - Force HTTPS for 1 year\n    add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\" always;\n    \n    # Prevent clickjacking\n    add_header X-Frame-Options \"SAMEORIGIN\" always;\n    \n    # Prevent MIME type sniffing\n    add_header X-Content-Type-Options \"nosniff\" always;\n    \n    # Control referrer information\n    add_header Referrer-Policy \"strict-origin-when-cross-origin\" always;\n    \n    # Comprehensive CSP\n    add_header Content-Security-Policy \"\n        default-src 'self';\n        script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net;\n        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;\n        font-src 'self' https://fonts.gstatic.com;\n        img-src 'self' data: https:;\n        connect-src 'self' https:;\n        frame-ancestors 'none';\n        base-uri 'self';\n        form-action 'self';\n        upgrade-insecure-requests;\n    \" always;\n    \n    # Control browser features\n    add_header Permissions-Policy \"\n        camera=(),\n        microphone=(),\n        geolocation=(),\n        payment=(),\n        usb=()\n    \" always;\n    \n    # Cross-origin policies\n    add_header Cross-Origin-Embedder-Policy \"credentialless\" always;\n    add_header Cross-Origin-Opener-Policy \"same-origin-allow-popups\" always;\n    \n    # Remove server information\n    add_header X-Powered-By \"\" always;\n    \n    # Custom security headers\n    add_header X-Robots-Tag \"noindex, nofollow\" always;  # For admin areas\n    add_header Cache-Control \"no-store, no-cache, must-revalidate\" always;  # For sensitive pages\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"environment-specific-configurations",children:"Environment-Specific Configurations"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Development Environment"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# Relaxed headers for development\nadd_header Content-Security-Policy \"\n    default-src 'self' 'unsafe-inline' 'unsafe-eval';\n    connect-src 'self' ws: wss: http: https:;\n\" always;\n\nadd_header Strict-Transport-Security \"max-age=300\" always;  # Short duration\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"API Endpoints"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'location /api/ {\n    # API-specific security headers\n    add_header X-Content-Type-Options "nosniff" always;\n    add_header X-Frame-Options "DENY" always;\n    add_header Cache-Control "no-store" always;\n    add_header Pragma "no-cache" always;\n    \n    # CORS headers (if needed)\n    add_header Access-Control-Allow-Origin "https://yourdomain.com" always;\n    add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS" always;\n    add_header Access-Control-Allow-Headers "Authorization, Content-Type" always;\n    add_header Access-Control-Max-Age "86400" always;\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Static Assets"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {\n    # Relaxed CSP for static assets\n    add_header Content-Security-Policy "default-src \'self\'" always;\n    add_header Cache-Control "public, max-age=31536000, immutable" always;\n    add_header X-Content-Type-Options "nosniff" always;\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"security-headers-testing-and-validation",children:"Security Headers Testing and Validation"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Tools for Testing Security Headers"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://securityheaders.com/",children:"Security Headers Scanner"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://observatory.mozilla.org/",children:"Mozilla Observatory"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://owasp.org/www-project-zap/",children:"OWASP ZAP"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Common CSP Testing"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# Report-only mode for testing CSP before enforcement\nadd_header Content-Security-Policy-Report-Only \"\n    default-src 'self';\n    report-uri /csp-report;\n\" always;\n\n# CSP violation reporting endpoint\nlocation /csp-report {\n    access_log /var/log/nginx/csp-violations.log;\n    return 204;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"modern-web-development-with-nginx",children:"Modern Web Development with Nginx"}),"\n",(0,s.jsx)(n.h3,{id:"microservices-architecture",children:"Microservices Architecture"}),"\n",(0,s.jsx)(n.p,{children:"Nginx excels in microservices environments, routing requests to different services based on URL patterns:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"location /auth/ {\n    proxy_pass http://auth-service:3001/;\n}\n\nlocation /users/ {\n    proxy_pass http://user-service:3002/;\n}\n\nlocation /orders/ {\n    proxy_pass http://order-service:3003/;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"api-gateway",children:"API Gateway"}),"\n",(0,s.jsx)(n.p,{children:"Use Nginx as an API gateway for request routing, authentication, and rate limiting:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'location /api/v1/ {\n    auth_request /auth;\n    proxy_pass http://api-backend/;\n}\n\nlocation = /auth {\n    internal;\n    proxy_pass http://auth-service/verify;\n    proxy_pass_request_body off;\n    proxy_set_header Content-Length "";\n    proxy_set_header X-Original-URI $request_uri;\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"monitoring-and-logging",children:"Monitoring and Logging"}),"\n",(0,s.jsx)(n.h3,{id:"access-logs",children:"Access Logs"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'log_format main \'$remote_addr - $remote_user [$time_local] "$request" \'\n                \'$status $body_bytes_sent "$http_referer" \'\n                \'"$http_user_agent" "$http_x_forwarded_for"\';\n\naccess_log /var/log/nginx/access.log main;\n'})}),"\n",(0,s.jsx)(n.h3,{id:"error-logs",children:"Error Logs"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"error_log /var/log/nginx/error.log warn;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"status-module",children:"Status Module"}),"\n",(0,s.jsx)(n.p,{children:"Enable the status module for monitoring:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"location /nginx_status {\n    stub_status on;\n    access_log off;\n    allow 127.0.0.1;\n    deny all;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(n.p,{children:"Nginx has proven itself as an indispensable tool in modern web infrastructure. Its performance, flexibility, and rich feature set make it suitable for everything from simple static websites to complex, high-traffic applications. Whether you're serving static content, implementing a reverse proxy, or building a sophisticated load balancing solution, Nginx provides the tools and performance you need."}),"\n",(0,s.jsx)(n.p,{children:"As web applications continue to evolve, Nginx remains at the forefront, adapting to new requirements while maintaining its core strengths: high performance, low resource usage, and exceptional reliability."}),"\n",(0,s.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://nginx.org/en/docs/",children:"Official Nginx Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.nginx.com/nginx/admin-guide/",children:"Nginx Admin Guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://certbot.eff.org/instructions?ws=nginx",children:"Let's Encrypt with Nginx"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://nginx.org/en/docs/http/ngx_http_core_module.html#optimization",children:"Nginx Performance Tuning"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Have you used Nginx in your projects? Share your experiences and configurations in the comments below!"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},2389:e=>{e.exports=JSON.parse('{"permalink":"/fullstack-dev/blog/nginx-web-server-guide","editUrl":"https://github.com/tamnk74/fullstack-dev/tree/main/docs-site/blog/2025-10-06-nginx-web-server-guide.md","source":"@site/blog/2025-10-06-nginx-web-server-guide.md","title":"Nginx: The High-Performance Web Server and Reverse Proxy","description":"Nginx (pronounced \\"engine-x\\") is one of the most popular and powerful web servers in the world, powering over 30% of all websites on the internet. Originally created by Igor Sysoev in 2004 to solve the C10K problem (handling 10,000 concurrent connections), Nginx has evolved into a versatile tool that serves as a web server, reverse proxy, load balancer, and HTTP cache.","date":"2025-10-06T00:00:00.000Z","tags":[{"inline":false,"label":"Nginx","permalink":"/fullstack-dev/blog/tags/nginx","description":"Nginx web server and configuration"},{"inline":false,"label":"Web Server","permalink":"/fullstack-dev/blog/tags/web-server","description":"Web server configuration and management"},{"inline":false,"label":"Reverse Proxy","permalink":"/fullstack-dev/blog/tags/reverse-proxy","description":"Reverse proxy configuration"},{"inline":false,"label":"Load Balancing","permalink":"/fullstack-dev/blog/tags/load-balancing","description":"Load balancing strategies"},{"inline":false,"label":"Performance","permalink":"/fullstack-dev/blog/tags/performance","description":"Performance optimization techniques"},{"inline":false,"label":"DevOps","permalink":"/fullstack-dev/blog/tags/devops","description":"DevOps practices and tools"}],"readingTime":12.85,"hasTruncateMarker":true,"authors":[{"name":"Tam Nguyen","title":"Full Stack Developer, Next.js for Production Creator","url":"https://github.com/tamnk74","page":{"permalink":"/fullstack-dev/blog/authors/tam"},"socials":{"github":"https://github.com/tamnk74"},"imageURL":"https://github.com/tamnk74.png","key":"tam"}],"frontMatter":{"slug":"nginx-web-server-guide","title":"Nginx: The High-Performance Web Server and Reverse Proxy","authors":["tam"],"tags":["nginx","web-server","reverse-proxy","load-balancing","performance","devops"]},"unlisted":false,"prevItem":{"title":"Building Secure Microservices: Authentication & Authorization with NestJS on GCP Kubernetes","permalink":"/fullstack-dev/blog/nestjs-auth-microservices-gcp-kubernetes"},"nextItem":{"title":"The Art of Prompt Engineering: How to Create Effective Prompts for AI","permalink":"/fullstack-dev/blog/how-to-create-good-prompts"}}')},7814:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>o});var i=r(9729);const s={},a=i.createContext(s);function t(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);