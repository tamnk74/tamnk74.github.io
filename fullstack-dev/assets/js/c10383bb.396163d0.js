"use strict";(self.webpackChunkdocs_site=self.webpackChunkdocs_site||[]).push([[2827],{5741:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var t=i(9729);const s={},r=t.createContext(s);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}},6110:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"security-practices/threat-modeling","title":"Ecommerce Application Threat Modeling Document","description":"Executive Summary","source":"@site/docs/security-practices/threat-modeling.md","sourceDirName":"security-practices","slug":"/security-practices/threat-modeling","permalink":"/fullstack-dev/docs/security-practices/threat-modeling","draft":false,"unlisted":false,"editUrl":"https://github.com/tamnk74/fullstack-dev/tree/main/docs-site/docs/security-practices/threat-modeling.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Security Implementation Guides","permalink":"/fullstack-dev/docs/security-practices/security-implementation/"},"next":{"title":"Authentication and Authorization Implementation","permalink":"/fullstack-dev/docs/security-practices/security-implementation/authentication-authorization"}}');var s=i(5813),r=i(5741);const l={},c="Ecommerce Application Threat Modeling Document",d={},a=[{value:"Executive Summary",id:"executive-summary",level:2},{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Application Overview",id:"application-overview",level:2},{value:"Technology Stack",id:"technology-stack",level:3},{value:"Business Context",id:"business-context",level:3},{value:"Architecture Analysis",id:"architecture-analysis",level:2},{value:"System Components",id:"system-components",level:3},{value:"Trust Boundaries",id:"trust-boundaries",level:3},{value:"Data Flow Analysis",id:"data-flow-analysis",level:3},{value:"Critical Data Flows:",id:"critical-data-flows",level:4},{value:"Threat Identification",id:"threat-identification",level:2},{value:"STRIDE Analysis",id:"stride-analysis",level:3},{value:"Spoofing (S)",id:"spoofing-s",level:4},{value:"Tampering (T)",id:"tampering-t",level:4},{value:"Repudiation (R)",id:"repudiation-r",level:4},{value:"Information Disclosure (I)",id:"information-disclosure-i",level:4},{value:"Denial of Service (D)",id:"denial-of-service-d",level:4},{value:"Elevation of Privilege (E)",id:"elevation-of-privilege-e",level:4},{value:"OWASP Top 10 Mapping",id:"owasp-top-10-mapping",level:3},{value:"A01: Broken Access Control",id:"a01-broken-access-control",level:4},{value:"A02: Cryptographic Failures",id:"a02-cryptographic-failures",level:4},{value:"A03: Injection",id:"a03-injection",level:4},{value:"A04: Insecure Design",id:"a04-insecure-design",level:4},{value:"A05: Security Misconfiguration",id:"a05-security-misconfiguration",level:4},{value:"A06: Vulnerable Components",id:"a06-vulnerable-components",level:4},{value:"A07: Identification and Authentication Failures",id:"a07-identification-and-authentication-failures",level:4},{value:"A08: Software and Data Integrity Failures",id:"a08-software-and-data-integrity-failures",level:4},{value:"A09: Security Logging and Monitoring Failures",id:"a09-security-logging-and-monitoring-failures",level:4},{value:"A10: Server-Side Request Forgery (SSRF)",id:"a10-server-side-request-forgery-ssrf",level:4},{value:"Risk Assessment",id:"risk-assessment",level:2},{value:"Risk Matrix",id:"risk-matrix",level:3},{value:"Priority Threats (Critical/High Risk)",id:"priority-threats-criticalhigh-risk",level:3},{value:"Security Controls",id:"security-controls",level:2},{value:"Existing Controls",id:"existing-controls",level:3},{value:"Authentication &amp; Authorization",id:"authentication--authorization",level:4},{value:"Data Protection",id:"data-protection",level:4},{value:"Infrastructure Security",id:"infrastructure-security",level:4},{value:"Application Security",id:"application-security",level:4},{value:"Monitoring &amp; Logging",id:"monitoring--logging",level:4},{value:"Security Testing",id:"security-testing",level:3},{value:"Mitigation Strategies",id:"mitigation-strategies",level:2},{value:"High Priority Mitigations",id:"high-priority-mitigations",level:3},{value:"1. Enhanced Authentication Security",id:"1-enhanced-authentication-security",level:4},{value:"2. API Security Hardening",id:"2-api-security-hardening",level:4},{value:"3. Database Security Enhancement",id:"3-database-security-enhancement",level:4},{value:"4. Frontend Security Measures",id:"4-frontend-security-measures",level:4},{value:"Medium Priority Mitigations",id:"medium-priority-mitigations",level:3},{value:"1. Enhanced Logging and Monitoring",id:"1-enhanced-logging-and-monitoring",level:4},{value:"2. Container Security",id:"2-container-security",level:4},{value:"3. Secrets Management",id:"3-secrets-management",level:4},{value:"Monitoring and Detection",id:"monitoring-and-detection",level:2},{value:"Security Monitoring Strategy",id:"security-monitoring-strategy",level:3},{value:"1. Real-time Threat Detection",id:"1-real-time-threat-detection",level:4},{value:"2. Security Metrics Dashboard",id:"2-security-metrics-dashboard",level:4},{value:"Alert Thresholds",id:"alert-thresholds",level:3},{value:"Incident Response",id:"incident-response",level:2},{value:"Security Incident Response Plan",id:"security-incident-response-plan",level:3},{value:"1. Incident Classification",id:"1-incident-classification",level:4},{value:"2. Response Procedures",id:"2-response-procedures",level:4},{value:"3. Communication Plan",id:"3-communication-plan",level:4},{value:"Recommendations",id:"recommendations",level:2},{value:"Immediate Actions (0-30 days)",id:"immediate-actions-0-30-days",level:3},{value:"Short-term Actions (1-3 months)",id:"short-term-actions-1-3-months",level:3},{value:"Long-term Actions (3-12 months)",id:"long-term-actions-3-12-months",level:3},{value:"Metrics for Success",id:"metrics-for-success",level:3},{value:"Conclusion",id:"conclusion",level:2}];function o(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"ecommerce-application-threat-modeling-document",children:"Ecommerce Application Threat Modeling Document"})}),"\n",(0,s.jsx)(n.h2,{id:"executive-summary",children:"Executive Summary"}),"\n",(0,s.jsx)(n.p,{children:"This document provides a comprehensive threat model for our ecommerce platform built using a modern microservices architecture with Next.js microfrontends and NestJS backend services. The analysis identifies potential security threats, vulnerabilities, and recommended mitigations across all layers of the application stack."}),"\n",(0,s.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#application-overview",children:"Application Overview"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#architecture-analysis",children:"Architecture Analysis"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#threat-identification",children:"Threat Identification"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#risk-assessment",children:"Risk Assessment"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#security-controls",children:"Security Controls"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#mitigation-strategies",children:"Mitigation Strategies"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#monitoring-and-detection",children:"Monitoring and Detection"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#incident-response",children:"Incident Response"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#recommendations",children:"Recommendations"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"application-overview",children:"Application Overview"}),"\n",(0,s.jsx)(n.h3,{id:"technology-stack",children:"Technology Stack"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Frontend:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Next.js 14+ with App Router"}),"\n",(0,s.jsx)(n.li,{children:"React 18+ with TypeScript"}),"\n",(0,s.jsx)(n.li,{children:"Tailwind CSS for styling"}),"\n",(0,s.jsx)(n.li,{children:"Module Federation for microfrontends"}),"\n",(0,s.jsx)(n.li,{children:"Redux Toolkit for state management"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Backend:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"NestJS microservices architecture"}),"\n",(0,s.jsx)(n.li,{children:"TypeORM for database operations"}),"\n",(0,s.jsx)(n.li,{children:"JWT-based authentication"}),"\n",(0,s.jsx)(n.li,{children:"API Gateway pattern"}),"\n",(0,s.jsx)(n.li,{children:"Message queues (Kafka/RabbitMQ)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Infrastructure:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Google Kubernetes Engine (GKE)"}),"\n",(0,s.jsx)(n.li,{children:"Cloud SQL (PostgreSQL)"}),"\n",(0,s.jsx)(n.li,{children:"Cloud Storage & Filestore"}),"\n",(0,s.jsx)(n.li,{children:"Redis for caching"}),"\n",(0,s.jsx)(n.li,{children:"Elasticsearch for search"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"DevOps & Security:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"GitHub Actions for CI/CD"}),"\n",(0,s.jsx)(n.li,{children:"ArgoCD for GitOps"}),"\n",(0,s.jsx)(n.li,{children:"OWASP ZAP for DAST"}),"\n",(0,s.jsx)(n.li,{children:"SonarQube for SAST"}),"\n",(0,s.jsx)(n.li,{children:"Datadog for monitoring"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"business-context",children:"Business Context"}),"\n",(0,s.jsx)(n.p,{children:"The ecommerce platform handles:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"User registration and authentication"}),"\n",(0,s.jsx)(n.li,{children:"Product catalog management"}),"\n",(0,s.jsx)(n.li,{children:"Shopping cart and checkout processes"}),"\n",(0,s.jsx)(n.li,{children:"Payment processing"}),"\n",(0,s.jsx)(n.li,{children:"Order management"}),"\n",(0,s.jsx)(n.li,{children:"Inventory tracking"}),"\n",(0,s.jsx)(n.li,{children:"Customer support"}),"\n",(0,s.jsx)(n.li,{children:"Administrative functions"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"architecture-analysis",children:"Architecture Analysis"}),"\n",(0,s.jsx)(n.h3,{id:"system-components",children:"System Components"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-mermaid",children:"graph TD\n    A[Users/Browsers] --\x3e B[Load Balancer/CDN]\n    B --\x3e C[API Gateway]\n    C --\x3e D[Authentication Service]\n    C --\x3e E[Product Service]\n    C --\x3e F[User Service]\n    C --\x3e G[Order Service]\n    C --\x3e H[Payment Service]\n    C --\x3e I[Inventory Service]\n\n    D --\x3e J[Identity Provider]\n    E --\x3e K[Product DB]\n    F --\x3e L[User DB]\n    G --\x3e M[Order DB]\n    H --\x3e N[Payment Gateway]\n    I --\x3e O[Inventory DB]\n\n    P[Message Queue] --\x3e E\n    P --\x3e F\n    P --\x3e G\n    P --\x3e I\n\n    Q[Redis Cache] --\x3e C\n    R[Elasticsearch] --\x3e E\n    S[File Storage] --\x3e E\n"})}),"\n",(0,s.jsx)(n.h3,{id:"trust-boundaries",children:"Trust Boundaries"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Internet to DMZ"}),": Public internet to load balancer/CDN"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DMZ to Application Layer"}),": Load balancer to API Gateway"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Application to Service Layer"}),": API Gateway to microservices"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Service to Data Layer"}),": Microservices to databases"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Internal Service Communication"}),": Inter-microservice communication"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Administrative Access"}),": Admin interfaces and tools"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"data-flow-analysis",children:"Data Flow Analysis"}),"\n",(0,s.jsx)(n.h4,{id:"critical-data-flows",children:"Critical Data Flows:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"User Authentication Flow"}),": User credentials \u2192 Auth Service \u2192 Identity Provider"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Product Browsing Flow"}),": User request \u2192 API Gateway \u2192 Product Service \u2192 Database"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Checkout Flow"}),": Cart data \u2192 Order Service \u2192 Payment Service \u2192 External Payment Gateway"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Administrative Flow"}),": Admin user \u2192 Admin interface \u2192 Administrative services"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"threat-identification",children:"Threat Identification"}),"\n",(0,s.jsx)(n.h3,{id:"stride-analysis",children:"STRIDE Analysis"}),"\n",(0,s.jsx)(n.h4,{id:"spoofing-s",children:"Spoofing (S)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Threat ID"}),(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Impact"}),(0,s.jsx)(n.th,{children:"Likelihood"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"S001"}),(0,s.jsx)(n.td,{children:"Authentication Service"}),(0,s.jsx)(n.td,{children:"Attacker impersonates legitimate user"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"S002"}),(0,s.jsx)(n.td,{children:"API Gateway"}),(0,s.jsx)(n.td,{children:"Service spoofing through compromised certificates"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Low"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"S003"}),(0,s.jsx)(n.td,{children:"Admin Interface"}),(0,s.jsx)(n.td,{children:"Admin impersonation through credential theft"}),(0,s.jsx)(n.td,{children:"Critical"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"S004"}),(0,s.jsx)(n.td,{children:"Inter-service Communication"}),(0,s.jsx)(n.td,{children:"Microservice impersonation"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Low"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"tampering-t",children:"Tampering (T)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Threat ID"}),(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Impact"}),(0,s.jsx)(n.th,{children:"Likelihood"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"T001"}),(0,s.jsx)(n.td,{children:"Client-Side Code"}),(0,s.jsx)(n.td,{children:"Manipulation of JavaScript/React components"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"High"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"T002"}),(0,s.jsx)(n.td,{children:"API Requests"}),(0,s.jsx)(n.td,{children:"Request manipulation/parameter tampering"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"High"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"T003"}),(0,s.jsx)(n.td,{children:"Database Records"}),(0,s.jsx)(n.td,{children:"Unauthorized data modification"}),(0,s.jsx)(n.td,{children:"Critical"}),(0,s.jsx)(n.td,{children:"Low"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"T004"}),(0,s.jsx)(n.td,{children:"Configuration Files"}),(0,s.jsx)(n.td,{children:"Tampering with service configurations"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Low"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"T005"}),(0,s.jsx)(n.td,{children:"Message Queue"}),(0,s.jsx)(n.td,{children:"Message tampering in transit"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Medium"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"repudiation-r",children:"Repudiation (R)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Threat ID"}),(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Impact"}),(0,s.jsx)(n.th,{children:"Likelihood"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"R001"}),(0,s.jsx)(n.td,{children:"Transaction Logs"}),(0,s.jsx)(n.td,{children:"Insufficient audit trails for transactions"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"R002"}),(0,s.jsx)(n.td,{children:"User Actions"}),(0,s.jsx)(n.td,{children:"Users denying performed actions"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"R003"}),(0,s.jsx)(n.td,{children:"Admin Actions"}),(0,s.jsx)(n.td,{children:"Admins denying administrative changes"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Low"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"information-disclosure-i",children:"Information Disclosure (I)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Threat ID"}),(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Impact"}),(0,s.jsx)(n.th,{children:"Likelihood"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"I001"}),(0,s.jsx)(n.td,{children:"API Responses"}),(0,s.jsx)(n.td,{children:"Sensitive data exposure in API responses"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"I002"}),(0,s.jsx)(n.td,{children:"Database"}),(0,s.jsx)(n.td,{children:"Direct database access/SQL injection"}),(0,s.jsx)(n.td,{children:"Critical"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"I003"}),(0,s.jsx)(n.td,{children:"Log Files"}),(0,s.jsx)(n.td,{children:"Sensitive information in application logs"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"High"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"I004"}),(0,s.jsx)(n.td,{children:"Error Messages"}),(0,s.jsx)(n.td,{children:"Information leakage through error responses"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"High"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"I005"}),(0,s.jsx)(n.td,{children:"Client Storage"}),(0,s.jsx)(n.td,{children:"Sensitive data in browser storage"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"I006"}),(0,s.jsx)(n.td,{children:"File Storage"}),(0,s.jsx)(n.td,{children:"Unauthorized access to stored files"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Medium"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"denial-of-service-d",children:"Denial of Service (D)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Threat ID"}),(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Impact"}),(0,s.jsx)(n.th,{children:"Likelihood"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"D001"}),(0,s.jsx)(n.td,{children:"API Gateway"}),(0,s.jsx)(n.td,{children:"DDoS attacks overwhelming gateway"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"High"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"D002"}),(0,s.jsx)(n.td,{children:"Database"}),(0,s.jsx)(n.td,{children:"Resource exhaustion through expensive queries"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"D003"}),(0,s.jsx)(n.td,{children:"Message Queue"}),(0,s.jsx)(n.td,{children:"Queue flooding/resource exhaustion"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"D004"}),(0,s.jsx)(n.td,{children:"File Upload"}),(0,s.jsx)(n.td,{children:"Large file uploads exhausting storage"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"High"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"elevation-of-privilege-e",children:"Elevation of Privilege (E)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Threat ID"}),(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Impact"}),(0,s.jsx)(n.th,{children:"Likelihood"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"E001"}),(0,s.jsx)(n.td,{children:"RBAC System"}),(0,s.jsx)(n.td,{children:"Privilege escalation through role manipulation"}),(0,s.jsx)(n.td,{children:"Critical"}),(0,s.jsx)(n.td,{children:"Low"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"E002"}),(0,s.jsx)(n.td,{children:"JWT Tokens"}),(0,s.jsx)(n.td,{children:"Token manipulation for elevated access"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"E003"}),(0,s.jsx)(n.td,{children:"Container Escape"}),(0,s.jsx)(n.td,{children:"Breaking out of container isolation"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Low"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"E004"}),(0,s.jsx)(n.td,{children:"Admin Functions"}),(0,s.jsx)(n.td,{children:"Unauthorized access to admin features"}),(0,s.jsx)(n.td,{children:"Critical"}),(0,s.jsx)(n.td,{children:"Medium"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"owasp-top-10-mapping",children:"OWASP Top 10 Mapping"}),"\n",(0,s.jsx)(n.h4,{id:"a01-broken-access-control",children:"A01: Broken Access Control"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": All microservices, Admin interfaces"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": Unauthorized data access, privilege escalation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": Direct object references, missing authorization checks"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"a02-cryptographic-failures",children:"A02: Cryptographic Failures"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": Authentication service, Payment service"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": Data exposure, credential theft"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": Weak encryption, exposed secrets"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"a03-injection",children:"A03: Injection"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": Database layer, Search functionality"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": Data breach, system compromise"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": SQL injection, NoSQL injection, Command injection"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"a04-insecure-design",children:"A04: Insecure Design"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": Overall architecture"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": Systemic vulnerabilities"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": Missing rate limiting, insufficient security controls"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"a05-security-misconfiguration",children:"A05: Security Misconfiguration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": All infrastructure components"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": System compromise, data exposure"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": Default credentials, unnecessary services, verbose error messages"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"a06-vulnerable-components",children:"A06: Vulnerable Components"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": All services using third-party dependencies"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": Known vulnerability exploitation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": Outdated frameworks, vulnerable libraries"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"a07-identification-and-authentication-failures",children:"A07: Identification and Authentication Failures"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": Authentication service, Session management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": Account takeover, unauthorized access"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": Weak passwords, session fixation"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"a08-software-and-data-integrity-failures",children:"A08: Software and Data Integrity Failures"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": CI/CD pipeline, Package management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": Supply chain attacks, compromised deployments"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": Compromised dependencies, unsigned packages"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"a09-security-logging-and-monitoring-failures",children:"A09: Security Logging and Monitoring Failures"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": All services"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": Delayed breach detection, compliance issues"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": Insufficient logging, no monitoring"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"a10-server-side-request-forgery-ssrf",children:"A10: Server-Side Request Forgery (SSRF)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components Affected"}),": Services making external requests"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Risks"}),": Internal network access, data exposure"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),": Unvalidated external API calls"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"risk-assessment",children:"Risk Assessment"}),"\n",(0,s.jsx)(n.h3,{id:"risk-matrix",children:"Risk Matrix"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Risk Level"}),(0,s.jsx)(n.th,{children:"Impact"}),(0,s.jsx)(n.th,{children:"Likelihood"}),(0,s.jsx)(n.th,{children:"Examples"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Critical"})}),(0,s.jsx)(n.td,{children:"Critical"}),(0,s.jsx)(n.td,{children:"High/Medium"}),(0,s.jsx)(n.td,{children:"Admin account compromise, Payment system breach"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"High"})}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"High/Medium"}),(0,s.jsx)(n.td,{children:"User data breach, API manipulation"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Medium"})}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Information disclosure, DoS attacks"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Low"})}),(0,s.jsx)(n.td,{children:"Low"}),(0,s.jsx)(n.td,{children:"Any"}),(0,s.jsx)(n.td,{children:"Non-sensitive information exposure"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"priority-threats-criticalhigh-risk",children:"Priority Threats (Critical/High Risk)"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Payment Data Breach"})," (Critical)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Impact: Financial loss, regulatory penalties, reputation damage"}),"\n",(0,s.jsx)(n.li,{children:"Likelihood: Medium"}),"\n",(0,s.jsx)(n.li,{children:"Components: Payment service, API Gateway, Database"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Admin Account Compromise"})," (Critical)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Impact: Full system control, data manipulation"}),"\n",(0,s.jsx)(n.li,{children:"Likelihood: Medium"}),"\n",(0,s.jsx)(n.li,{children:"Components: Admin interface, Authentication service"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Customer Data Breach"})," (High)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Impact: Privacy violations, regulatory penalties"}),"\n",(0,s.jsx)(n.li,{children:"Likelihood: Medium"}),"\n",(0,s.jsx)(n.li,{children:"Components: User service, Database, API responses"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"API Abuse/DDoS"})," (High)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Impact: Service unavailability, resource costs"}),"\n",(0,s.jsx)(n.li,{children:"Likelihood: High"}),"\n",(0,s.jsx)(n.li,{children:"Components: API Gateway, Load balancer"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"security-controls",children:"Security Controls"}),"\n",(0,s.jsx)(n.h3,{id:"existing-controls",children:"Existing Controls"}),"\n",(0,s.jsx)(n.h4,{id:"authentication--authorization",children:"Authentication & Authorization"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"JWT-based authentication"}),"\n",(0,s.jsx)(n.li,{children:"RBAC implementation"}),"\n",(0,s.jsx)(n.li,{children:"OAuth2/OpenID Connect integration"}),"\n",(0,s.jsx)(n.li,{children:"Multi-factor authentication support"}),"\n",(0,s.jsx)(n.li,{children:"Session management"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"data-protection",children:"Data Protection"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Database encryption at rest"}),"\n",(0,s.jsx)(n.li,{children:"TLS encryption in transit"}),"\n",(0,s.jsx)(n.li,{children:"PII data classification"}),"\n",(0,s.jsx)(n.li,{children:"Data retention policies"}),"\n",(0,s.jsx)(n.li,{children:"Secure key management"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"infrastructure-security",children:"Infrastructure Security"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Container security scanning"}),"\n",(0,s.jsx)(n.li,{children:"Network segmentation"}),"\n",(0,s.jsx)(n.li,{children:"Firewall rules"}),"\n",(0,s.jsx)(n.li,{children:"VPC isolation"}),"\n",(0,s.jsx)(n.li,{children:"Service mesh security (mTLS)"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"application-security",children:"Application Security"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Input validation"}),"\n",(0,s.jsx)(n.li,{children:"Output encoding"}),"\n",(0,s.jsx)(n.li,{children:"CSRF protection"}),"\n",(0,s.jsx)(n.li,{children:"Content Security Policy"}),"\n",(0,s.jsx)(n.li,{children:"Rate limiting"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"monitoring--logging",children:"Monitoring & Logging"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Centralized logging (Datadog)"}),"\n",(0,s.jsx)(n.li,{children:"Security event monitoring"}),"\n",(0,s.jsx)(n.li,{children:"Performance monitoring"}),"\n",(0,s.jsx)(n.li,{children:"Alerting system"}),"\n",(0,s.jsx)(n.li,{children:"Audit trails"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"security-testing",children:"Security Testing"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"SAST (SonarQube)"}),"\n",(0,s.jsx)(n.li,{children:"DAST (OWASP ZAP)"}),"\n",(0,s.jsx)(n.li,{children:"Dependency scanning (GitHub Dependabot)"}),"\n",(0,s.jsx)(n.li,{children:"Container scanning"}),"\n",(0,s.jsx)(n.li,{children:"Penetration testing"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"mitigation-strategies",children:"Mitigation Strategies"}),"\n",(0,s.jsx)(n.h3,{id:"high-priority-mitigations",children:"High Priority Mitigations"}),"\n",(0,s.jsx)(n.h4,{id:"1-enhanced-authentication-security",children:"1. Enhanced Authentication Security"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Implementation Timeline: 2-4 weeks"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Enhanced JWT token validation\n@Injectable()\nexport class JwtAuthGuard implements CanActivate {\n  async canActivate(context: ExecutionContext): Promise<boolean> {\n    const request = context.switchToHttp().getRequest();\n    const token = this.extractTokenFromHeader(request);\n\n    if (!token) {\n      throw new UnauthorizedException();\n    }\n\n    try {\n      // Validate token signature and expiration\n      const payload = await this.jwtService.verifyAsync(token, {\n        secret: process.env.JWT_SECRET,\n        issuer: process.env.JWT_ISSUER,\n        audience: process.env.JWT_AUDIENCE,\n      });\n\n      // Additional security checks\n      await this.validateTokenClaims(payload);\n      await this.checkTokenRevocation(payload.jti);\n\n      request['user'] = payload;\n    } catch {\n      throw new UnauthorizedException();\n    }\n    return true;\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"2-api-security-hardening",children:"2. API Security Hardening"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Implementation Timeline: 3-6 weeks"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Rate limiting implementation\n@Controller('api')\n@UseGuards(ThrottlerGuard)\nexport class ApiController {\n  @Throttle({ default: { limit: 100, ttl: 60000 } })\n  @Post('sensitive-endpoint')\n  async sensitiveOperation(@Body() data: SensitiveDto) {\n    // Input validation\n    await this.validateInput(data);\n    // Business logic\n    return await this.processRequest(data);\n  }\n}\n\n// Input validation middleware\nexport class ValidationPipe implements PipeTransform {\n  transform(value: any, metadata: ArgumentMetadata) {\n    // Sanitize input\n    const sanitized = this.sanitizeInput(value);\n    // Validate against schema\n    const validated = this.validateSchema(sanitized, metadata);\n    return validated;\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"3-database-security-enhancement",children:"3. Database Security Enhancement"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Implementation Timeline: 2-3 weeks"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Query parameterization\n@Entity('users')\nexport class User {\n  // Use parameterized queries\n  static async findByEmail(email: string): Promise<User> {\n    return await this.createQueryBuilder('user').where('user.email = :email', { email }).getOne();\n  }\n}\n\n// Row-level security implementation\n@Entity('orders')\nexport class Order {\n  @CreateDateColumn()\n  createdAt: Date;\n\n  @Column()\n  userId: string;\n\n  // Ensure users can only access their own orders\n  static async findUserOrders(userId: string): Promise<Order[]> {\n    return await this.find({\n      where: { userId },\n      select: ['id', 'createdAt', 'status', 'total'],\n    });\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"4-frontend-security-measures",children:"4. Frontend Security Measures"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Implementation Timeline: 2-4 weeks"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Content Security Policy\nconst securityHeaders = {\n  'Content-Security-Policy': [\n    \"default-src 'self'\",\n    \"script-src 'self' 'unsafe-inline' https://trusted-cdn.com\",\n    \"style-src 'self' 'unsafe-inline'\",\n    \"img-src 'self' data: https:\",\n    \"connect-src 'self' https://api.yourdomain.com\",\n    \"frame-ancestors 'none'\",\n  ].join('; '),\n  'X-Frame-Options': 'DENY',\n  'X-Content-Type-Options': 'nosniff',\n  'Referrer-Policy': 'strict-origin-when-cross-origin',\n};\n\n// Secure data handling\nconst SecureStorageService = {\n  setItem: (key: string, value: any) => {\n    // Encrypt sensitive data before storing\n    const encrypted = encrypt(JSON.stringify(value));\n    sessionStorage.setItem(key, encrypted);\n  },\n\n  getItem: (key: string) => {\n    const encrypted = sessionStorage.getItem(key);\n    if (encrypted) {\n      return JSON.parse(decrypt(encrypted));\n    }\n    return null;\n  },\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"medium-priority-mitigations",children:"Medium Priority Mitigations"}),"\n",(0,s.jsx)(n.h4,{id:"1-enhanced-logging-and-monitoring",children:"1. Enhanced Logging and Monitoring"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Implementation Timeline: 4-6 weeks"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Security event logging\n@Injectable()\nexport class SecurityLogger {\n  private readonly logger = new Logger(SecurityLogger.name);\n\n  logAuthenticationAttempt(userId: string, success: boolean, ip: string) {\n    this.logger.log({\n      event: 'authentication_attempt',\n      userId,\n      success,\n      ip,\n      timestamp: new Date().toISOString(),\n    });\n  }\n\n  logSuspiciousActivity(userId: string, activity: string, details: any) {\n    this.logger.warn({\n      event: 'suspicious_activity',\n      userId,\n      activity,\n      details,\n      timestamp: new Date().toISOString(),\n    });\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"2-container-security",children:"2. Container Security"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Implementation Timeline: 2-3 weeks"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'# Secure container configuration\nFROM node:18-alpine AS base\n\n# Create non-root user\nRUN addgroup -g 1001 -S nodejs\nRUN adduser -S nestjs -u 1001\n\n# Security hardening\nRUN apk add --no-cache dumb-init\nRUN rm -rf /var/cache/apk/*\n\n# Copy application files\nCOPY --chown=nestjs:nodejs . .\n\n# Switch to non-root user\nUSER nestjs\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n  CMD curl -f http://localhost:3000/health || exit 1\n\nENTRYPOINT ["dumb-init", "--"]\nCMD ["node", "dist/main"]\n'})}),"\n",(0,s.jsx)(n.h4,{id:"3-secrets-management",children:"3. Secrets Management"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Implementation Timeline: 3-4 weeks"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Secure configuration management\n@Injectable()\nexport class ConfigService {\n  private readonly config: Record<string, any>;\n\n  constructor() {\n    this.config = {\n      database: {\n        host: this.getSecret('DB_HOST'),\n        password: this.getSecret('DB_PASSWORD'),\n      },\n      jwt: {\n        secret: this.getSecret('JWT_SECRET'),\n        expiresIn: process.env.JWT_EXPIRES_IN || '1h',\n      },\n      encryption: {\n        algorithm: 'aes-256-gcm',\n        key: this.getSecret('ENCRYPTION_KEY'),\n      },\n    };\n  }\n\n  private getSecret(key: string): string {\n    // Integration with Google Secret Manager\n    return process.env[key] || this.getFromSecretManager(key);\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"monitoring-and-detection",children:"Monitoring and Detection"}),"\n",(0,s.jsx)(n.h3,{id:"security-monitoring-strategy",children:"Security Monitoring Strategy"}),"\n",(0,s.jsx)(n.h4,{id:"1-real-time-threat-detection",children:"1. Real-time Threat Detection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Anomaly detection service\n@Injectable()\nexport class ThreatDetectionService {\n  private readonly redis: Redis;\n\n  async detectAnomalousLogin(userId: string, ip: string, userAgent: string) {\n    const key = `login_pattern:${userId}`;\n    const recentLogins = await this.redis.lrange(key, 0, 10);\n\n    // Check for suspicious patterns\n    if (this.isAnomalousLocation(ip, recentLogins)) {\n      await this.triggerSecurityAlert('anomalous_location', { userId, ip });\n    }\n\n    if (this.isAnomalousDevice(userAgent, recentLogins)) {\n      await this.triggerSecurityAlert('new_device', { userId, userAgent });\n    }\n  }\n\n  async detectBruteForce(ip: string) {\n    const attempts = await this.redis.incr(`failed_attempts:${ip}`);\n    await this.redis.expire(`failed_attempts:${ip}`, 900); // 15 minutes\n\n    if (attempts > 5) {\n      await this.blockIP(ip, 3600); // 1 hour\n      await this.triggerSecurityAlert('brute_force', { ip, attempts });\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"2-security-metrics-dashboard",children:"2. Security Metrics Dashboard"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Security metrics collection\n@Injectable()\nexport class SecurityMetricsService {\n  private readonly metricsCollector: DatadogMetrics;\n\n  recordAuthenticationEvent(success: boolean, method: string) {\n    this.metricsCollector.increment('auth.attempts', 1, {\n      success: success.toString(),\n      method,\n    });\n  }\n\n  recordAPICall(endpoint: string, statusCode: number, responseTime: number) {\n    this.metricsCollector.increment('api.calls', 1, {\n      endpoint,\n      status: statusCode.toString(),\n    });\n\n    this.metricsCollector.histogram('api.response_time', responseTime, {\n      endpoint,\n    });\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"alert-thresholds",children:"Alert Thresholds"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Metric"}),(0,s.jsx)(n.th,{children:"Warning"}),(0,s.jsx)(n.th,{children:"Critical"}),(0,s.jsx)(n.th,{children:"Action"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Failed login attempts"}),(0,s.jsx)(n.td,{children:"> 10/min"}),(0,s.jsx)(n.td,{children:"> 50/min"}),(0,s.jsx)(n.td,{children:"Rate limit, investigate"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"API error rate"}),(0,s.jsx)(n.td,{children:"> 5%"}),(0,s.jsx)(n.td,{children:"> 15%"}),(0,s.jsx)(n.td,{children:"Scale resources, check logs"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Unusual data access"}),(0,s.jsx)(n.td,{children:"Any"}),(0,s.jsx)(n.td,{children:"Any"}),(0,s.jsx)(n.td,{children:"Immediate investigation"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Admin privilege use"}),(0,s.jsx)(n.td,{children:"Any"}),(0,s.jsx)(n.td,{children:"Any"}),(0,s.jsx)(n.td,{children:"Audit trail review"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"incident-response",children:"Incident Response"}),"\n",(0,s.jsx)(n.h3,{id:"security-incident-response-plan",children:"Security Incident Response Plan"}),"\n",(0,s.jsx)(n.h4,{id:"1-incident-classification",children:"1. Incident Classification"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"P0 (Critical)"}),": Active breach, data exposure, system compromise"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"P1 (High)"}),": Potential breach, security control bypass"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"P2 (Medium)"}),": Policy violations, suspicious activity"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"P3 (Low)"}),": Security warnings, minor violations"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"2-response-procedures",children:"2. Response Procedures"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Automated incident response\n@Injectable()\nexport class IncidentResponseService {\n  async handleSecurityIncident(incident: SecurityIncident) {\n    // Immediate containment\n    if (incident.severity === 'critical') {\n      await this.emergencyContainment(incident);\n    }\n\n    // Notification\n    await this.notifySecurityTeam(incident);\n\n    // Evidence collection\n    await this.collectEvidence(incident);\n\n    // Remediation\n    await this.initiateRemediation(incident);\n  }\n\n  private async emergencyContainment(incident: SecurityIncident) {\n    switch (incident.type) {\n      case 'account_compromise':\n        await this.disableUserAccount(incident.userId);\n        break;\n      case 'suspicious_admin_activity':\n        await this.disableAdminSession(incident.sessionId);\n        break;\n      case 'data_breach':\n        await this.enableEmergencyMode();\n        break;\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"3-communication-plan",children:"3. Communication Plan"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Internal"}),": Security team, DevOps, Management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"External"}),": Customers (if applicable), Regulators, Partners"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Timeline"}),": Initial response within 1 hour, updates every 4 hours"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"recommendations",children:"Recommendations"}),"\n",(0,s.jsx)(n.h3,{id:"immediate-actions-0-30-days",children:"Immediate Actions (0-30 days)"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Implement Enhanced Authentication"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Multi-factor authentication for all admin accounts"}),"\n",(0,s.jsx)(n.li,{children:"Token refresh mechanisms"}),"\n",(0,s.jsx)(n.li,{children:"Account lockout policies"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"API Security Hardening"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implement comprehensive rate limiting"}),"\n",(0,s.jsx)(n.li,{children:"Add request validation middleware"}),"\n",(0,s.jsx)(n.li,{children:"Enable API security logging"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Database Security"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Enable query logging and monitoring"}),"\n",(0,s.jsx)(n.li,{children:"Implement database activity monitoring"}),"\n",(0,s.jsx)(n.li,{children:"Review and update access controls"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"short-term-actions-1-3-months",children:"Short-term Actions (1-3 months)"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Security Testing Integration"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Integrate security tests into CI/CD pipeline"}),"\n",(0,s.jsx)(n.li,{children:"Automated vulnerability scanning"}),"\n",(0,s.jsx)(n.li,{children:"Regular penetration testing"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Monitoring Enhancement"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implement SIEM solution"}),"\n",(0,s.jsx)(n.li,{children:"Security dashboard creation"}),"\n",(0,s.jsx)(n.li,{children:"Automated alerting rules"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Security Training"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Developer security training program"}),"\n",(0,s.jsx)(n.li,{children:"Security code review guidelines"}),"\n",(0,s.jsx)(n.li,{children:"Incident response training"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"long-term-actions-3-12-months",children:"Long-term Actions (3-12 months)"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Zero Trust Architecture"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Service-to-service authentication"}),"\n",(0,s.jsx)(n.li,{children:"Network micro-segmentation"}),"\n",(0,s.jsx)(n.li,{children:"Continuous trust evaluation"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Advanced Threat Detection"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Machine learning-based anomaly detection"}),"\n",(0,s.jsx)(n.li,{children:"Behavioral analysis"}),"\n",(0,s.jsx)(n.li,{children:"Threat intelligence integration"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Compliance and Governance"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Regular security assessments"}),"\n",(0,s.jsx)(n.li,{children:"Compliance framework implementation"}),"\n",(0,s.jsx)(n.li,{children:"Security governance program"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"metrics-for-success",children:"Metrics for Success"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Metric"}),(0,s.jsx)(n.th,{children:"Current"}),(0,s.jsx)(n.th,{children:"Target"}),(0,s.jsx)(n.th,{children:"Timeline"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Security incidents"}),(0,s.jsx)(n.td,{children:"Baseline"}),(0,s.jsx)(n.td,{children:"-50%"}),(0,s.jsx)(n.td,{children:"6 months"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Vulnerability resolution time"}),(0,s.jsx)(n.td,{children:"TBD"}),(0,s.jsx)(n.td,{children:"< 24 hours (Critical)"}),(0,s.jsx)(n.td,{children:"3 months"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Security test coverage"}),(0,s.jsx)(n.td,{children:"TBD"}),(0,s.jsx)(n.td,{children:"> 80%"}),(0,s.jsx)(n.td,{children:"6 months"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Mean time to detection"}),(0,s.jsx)(n.td,{children:"TBD"}),(0,s.jsx)(n.td,{children:"< 5 minutes"}),(0,s.jsx)(n.td,{children:"12 months"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(n.p,{children:"This threat model provides a comprehensive security analysis of the ecommerce platform. The identified threats and recommended mitigations should be prioritized based on risk level and business impact. Regular reviews and updates of this document are essential as the application evolves and new threats emerge."}),"\n",(0,s.jsx)(n.p,{children:"The implementation of the recommended security controls will significantly improve the security posture of the application and reduce the likelihood and impact of security incidents."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Document Version"}),": 1.0",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Last Updated"}),": October 2025",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Next Review"}),": January 2026",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Owner"}),": Security Team",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Approved By"}),": Technical Architect, Security Officer"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);